<!DOCTYPE html><html lang="zh-TW" class="loading"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><title>透過 Github Issue 更新 Blog 內容 (Firebase 版) - 淼 Be Water</title><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="google" content="notranslate"><meta name="keywords" content="Web,JavaScript,JS,Nodejs,開發,Development,"><meta name="description" content="Who is Wei Hong-Lin (Ivan Wei),主流寫文章的網站有 Pixnet 、  Medium 、 Github page 、 ghost 等，除了 Github page 外其餘皆自帶即時的 內容管理 ；然而 Github page 是許,"><meta name="author" content="Wei Hong-Lin (Ivan Wei)"><link rel="alternative" href="atom.xml" title="淼 Be Water" type="application/atom+xml"><link rel="icon" href="/img/favicon.png"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="透過 Github Issue 更新 Blog 內容 (Firebase 版) - 淼 Be Water"><meta name="twitter:description" content="Who is Wei Hong-Lin (Ivan Wei),主流寫文章的網站有 Pixnet 、  Medium 、 Github page 、 ghost 等，除了 Github page 外其餘皆自帶即時的 內容管理 ；然而 Github page 是許,"><meta property="og:site_name" content="淼 Be Water"><meta property="og:type" content="object"><meta property="og:title" content="透過 Github Issue 更新 Blog 內容 (Firebase 版) - 淼 Be Water"><meta property="og:description" content="Who is Wei Hong-Lin (Ivan Wei),主流寫文章的網站有 Pixnet 、  Medium 、 Github page 、 ghost 等，除了 Github page 外其餘皆自帶即時的 內容管理 ；然而 Github page 是許,"><link rel="stylesheet" href="/css/diaspora.css"><meta name="generator" content="Hexo 6.2.0"></head><body class="loading"><span id="config-title" style="display:none">淼 Be Water</span><div id="loader"></div><div id="single"><div id="top" style="display:block"><div class="bar" style="width:0"></div><a class="iconfont icon-home image-icon" href="javascript:;" data-url="https://blog.ivanwei.co"></a><div title="播放/暂停" class="iconfont icon-play"></div><h3 class="subtitle">透過 Github Issue 更新 Blog 內容 (Firebase 版)</h3><div class="social"><div><div class="share"><a title="获取二维码" class="iconfont icon-scan" href="javascript:;"></a></div><div id="qr"></div></div></div><div class="scrollbar"></div></div><div class="section"><div class="article"><div class="main"><h1 class="title">透過 Github Issue 更新 Blog 內容 (Firebase 版)</h1><div class="stuff"><span>七月 01, 2019</span></div><div class="content markdown"><p>主流寫文章的網站有 <a target="_blank" rel="noopener" href="https://www.pixnet.net/">Pixnet</a> 、 <a target="_blank" rel="noopener" href="https://medium.com/">Medium</a> 、 <a target="_blank" rel="noopener" href="https://pages.github.com/">Github page</a> 、 <a target="_blank" rel="noopener" href="https://ghost.org/">ghost</a> 等，除了 Github page<br>外其餘皆自帶即時的 <strong>內容管理</strong> ；然而 Github page 是許多剛入門寫程式人第一個架站的首選或架 Blog ，卻無法隨地更新 Blog 內容，進而讓我懶得更新 Blog。</p><p>苦思之後有了今天這篇，分享如何讓 Github Issue 成為 Blog 的內容管理器。</p><span id="more"></span><h2 id="第零步-準備好使用到的服務"><a href="#第零步-準備好使用到的服務" class="headerlink" title="第零步 - 準備好使用到的服務"></a>第零步 - 準備好使用到的服務</h2><ol><li>Github<ul><li>使用其 Issue 、 Webhook 、 API 、 Developer 身份 (Free)</li></ul></li><li>Travis CI<ul><li>需要透過 Travis CI 的手動觸發進行部署</li><li><a target="_blank" rel="noopener" href="https://circleci.com/">Circle CI</a> 尚未支援手動觸發</li></ul></li><li>準備一臺 Server<ul><li>部署 Github 的 Webhook 使用</li><li>範列使用 <a target="_blank" rel="noopener" href="https://firebase.google.com/docs/functions">Firebase functions</a> ，使用此方法先確認自己有能使用的信用卡，為了解除某些限制而不得不的處理</li></ul></li><li>Node.js v8.9.0 or above</li></ol><h2 id="第一步-下載-Issue-的-Markdown-內容"><a href="#第一步-下載-Issue-的-Markdown-內容" class="headerlink" title="第一步 - 下載 Issue 的 Markdown 內容"></a>第一步 - 下載 Issue 的 Markdown 內容</h2><h3 id="取得-Repository-操作權限"><a href="#取得-Repository-操作權限" class="headerlink" title="取得 Repository 操作權限"></a>取得 Repository 操作權限</h3><ol><li><p>在 Profile 中進入 Developer settings<br><img src="https://user-images.githubusercontent.com/6157049/60479293-da7bb780-9cb7-11e9-8df2-67dee6b1a156.png" alt="Developer settings"></p></li><li><p>選擇建立 <strong>Personal access tokens</strong><br><img src="https://user-images.githubusercontent.com/6157049/60480720-35fc7400-9cbd-11e9-823f-2761bee37eab.png" alt="Personal access tokens"></p></li><li><p>授權範圍選擇 public_repo ，若指定的 Repository 是 Private 則必須勾所有控制權<br><img src="https://user-images.githubusercontent.com/6157049/60481253-2c740b80-9cbf-11e9-87d6-6d02ad71ff14.png" alt="Repository controller"></p></li><li><p>記住產生出來的 Token ，試試能否取到 Repository 裡的 issues ，正確會吐 Array 回來，而 issue 的內容存在 body 中<br><code>$ curl -H &quot;Authorization: token [Token]&quot; https://api.github.com/repos/[user id]/[repository name]/issues</code></p></li><li><p>上一步沒問題既可透過 Ajax 方式取得 Response 後，將 issue 存成 Markdown 檔，下面以 fetch 為範例</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fetch = <span class="built_in">require</span>(<span class="string">&#x27;node-fetch&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">fetch</span>(<span class="string">&#x27;https://api.github.com/repos/ivanwei/blog/issues&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">  <span class="attr">headers</span>: &#123;</span><br><span class="line">    <span class="string">&#x27;Authorization&#x27;</span>: <span class="string">`token <span class="subst">$&#123;gitToken&#125;</span>`</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">.<span class="title function_">then</span>(<span class="keyword">async</span> (response) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> result = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;result 的跑迴圈取一個 body&#x27;</span>);</span><br><span class="line">&#125;)</span><br><span class="line">.<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;error handler&#x27;</span>)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li></ol><h3 id="issue-存成-Markdown"><a href="#issue-存成-Markdown" class="headerlink" title="issue 存成 Markdown"></a>issue 存成 Markdown</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs =<span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> util =<span class="built_in">require</span>(<span class="string">&#x27;util&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 將 fs.writeFile 包成 Promise</span></span><br><span class="line"><span class="keyword">const</span> writeFile = util.<span class="title function_">promisify</span>(fs.<span class="property">writeFile</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 建立檔案或覆寫檔案</span></span><br><span class="line"><span class="title function_">writeFile</span>(<span class="string">`<span class="subst">$&#123;outputPath&#125;</span>/$ci-gh-integration.md`</span>, content)</span><br><span class="line">.<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;File was created.&#x27;</span>);</span><br><span class="line">&#125;)</span><br><span class="line">.<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;File was not created.&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="第一步-小結，還是使用寫好的工具做比較簡單"><a href="#第一步-小結，還是使用寫好的工具做比較簡單" class="headerlink" title="第一步 - 小結，還是使用寫好的工具做比較簡單"></a>第一步 - 小結，還是使用寫好的工具做比較簡單</h3><p>以上兩者結合既完成 issue 轉成 Markdown ，若覺得過程可以使用 <a target="_blank" rel="noopener" href="https://github.com/IvanWei/blog-content-source-cli">@ivanwei&#x2F;blog-content-source-cli</a> ，將上述打包在一起，用法也相對簡單許許。</p><h4 id="安裝-ivanwei-x2F-git-issue-hexo-cli"><a href="#安裝-ivanwei-x2F-git-issue-hexo-cli" class="headerlink" title="安裝 @ivanwei&#x2F;git-issue-hexo-cli"></a>安裝 @ivanwei&#x2F;git-issue-hexo-cli</h4><blockquote><p>$ yarn add @ivanwei&#x2F;git-issue-hexo-cli</p></blockquote><h4 id="使用方式"><a href="#使用方式" class="headerlink" title="使用方式"></a>使用方式</h4><blockquote><p>$ b.content refresh -R &lt;Repository&gt; -u &lt;username&gt; -l &lt;Issue 有這 label 既存成 MD 檔&gt; –git-token<github personal access token>-o &lt;存檔的資料夾&gt;</github></p></blockquote><p>接下來會使用 <a target="_blank" rel="noopener" href="https://github.com/IvanWei/git-issue-hexo-cli">@ivanwei&#x2F;git-issue-hexo-cli</a> 來操作 issue 部分，有興趣自己手動做可以看 <a target="_blank" rel="noopener" href="https://developer.github.com/v3/issues/#list-issues-for-a-repository">Github API</a> ，因為前者也是使用同樣的內容加上一些步驟集結而成。</p><h2 id="第二步-設定-Github-Webhook"><a href="#第二步-設定-Github-Webhook" class="headerlink" title="第二步 - 設定 Github Webhook"></a>第二步 - 設定 Github Webhook</h2><p>此處內容以 firebase functions 配上 Express 為範例， firebase 相關設定可以看<a target="_blank" rel="noopener" href="https://firebase.google.com/docs/functions/get-started">這篇</a> 或按下面步驟建立</p><h3 id="建立-Firebase-專案"><a href="#建立-Firebase-專案" class="headerlink" title="建立 Firebase 專案"></a>建立 Firebase 專案</h3><p>首到 <a target="_blank" rel="noopener" href="https://console.firebase.google.com/">Firebase 建立專案</a></p><h3 id="安裝-Firebase-CLI"><a href="#安裝-Firebase-CLI" class="headerlink" title="安裝 Firebase CLI"></a>安裝 Firebase CLI</h3><blockquote><p>$ npm install -g firebase-tools &#x2F; $ yarn global add firebase-tools</p></blockquote><h3 id="登入-Firebase"><a href="#登入-Firebase" class="headerlink" title="登入 Firebase"></a>登入 Firebase</h3><blockquote><p>$ firebase login</p></blockquote><h3 id="初始化-firebase-functions"><a href="#初始化-firebase-functions" class="headerlink" title="初始化 firebase functions"></a>初始化 firebase functions</h3><blockquote><p>$ firebase init functions</p></blockquote><h3 id="設定-Firebase-project"><a href="#設定-Firebase-project" class="headerlink" title="設定 Firebase project"></a>設定 Firebase project</h3><h4 id="索取-Firebase-現有的-Project-清單"><a href="#索取-Firebase-現有的-Project-清單" class="headerlink" title="索取 Firebase 現有的 Project 清單"></a>索取 Firebase 現有的 Project 清單</h4><blockquote><p>$ firebase list</p></blockquote><p><img src="https://user-images.githubusercontent.com/6157049/60560406-432f6680-9d82-11e9-88e9-4b776f2dd14e.png" alt="Firebase List"></p><h4 id="指定-Firebase-使用的專案"><a href="#指定-Firebase-使用的專案" class="headerlink" title="指定 Firebase 使用的專案"></a>指定 Firebase 使用的專案</h4><blockquote><p>$ firebase use<project></project></p></blockquote><h3 id="撰寫-Serverless-內容"><a href="#撰寫-Serverless-內容" class="headerlink" title="撰寫 Serverless 內容"></a>撰寫 Serverless 內容</h3><h4 id="切換到-functions-資料夾"><a href="#切換到-functions-資料夾" class="headerlink" title="切換到 functions 資料夾"></a>切換到 functions 資料夾</h4><blockquote><p>$ cd functions</p></blockquote><h4 id="安裝-express-和-node-fetch"><a href="#安裝-express-和-node-fetch" class="headerlink" title="安裝 express 和 node-fetch"></a>安裝 express 和 node-fetch</h4><blockquote><p>$ npm install express node-fetch &#x2F; yarn add express node-fetch</p></blockquote><h4 id="更新-index-js"><a href="#更新-index-js" class="headerlink" title="更新 index.js"></a>更新 index.js</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> functions = <span class="built_in">require</span>(<span class="string">&#x27;firebase-functions&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fetch = <span class="built_in">require</span>(<span class="string">&#x27;node-fetch&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = <span class="title function_">express</span>();</span><br><span class="line">server.<span class="title function_">use</span>(express.<span class="title function_">json</span>());</span><br><span class="line"></span><br><span class="line">server.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">async</span> (req, res, next) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123;issue&#125; = req.<span class="property">body</span>;</span><br><span class="line">  <span class="keyword">const</span> &#123;title, state, body&#125; = issue;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 判斷 Issue 是否被關閉</span></span><br><span class="line">    <span class="keyword">if</span> (state === <span class="string">&#x27;open&#x27;</span>) &#123;</span><br><span class="line">      res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">send</span>(<span class="string">&#x27;Publish!!&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">send</span>(<span class="string">&#x27;No Publish, status is not open!!&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">send</span>(err);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">next</span>(err);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">github</span> = functions.<span class="property">https</span>.<span class="title function_">onRequest</span>(server);</span><br></pre></td></tr></table></figure><h4 id="部署到-Firebase-functions"><a href="#部署到-Firebase-functions" class="headerlink" title="部署到 Firebase functions"></a>部署到 Firebase functions</h4><blockquote><p>$ firebase deploy –only functions</p></blockquote><p>部署後 Terminal 會回傳一串 URL ，此時可以使用 cURL 、 Postman 或寫個 Ajax 程序試送 request ，試試看是否能收到 response。</p><p>Firebase 回傳的 URL 會長得像</p><blockquote><p>https:&#x2F;&#x2F;&lt;你選得專案地方&gt;-&lt;專案 ID&gt;.cloudfunctions.net&#x2F;&lt;export 的名稱&gt;</p></blockquote><p>若沒看到或忘記這串 URL ，可以到指定的 Firebase 專案點 functions ，找找要的 <code>export 名稱</code></p><p><img src="https://user-images.githubusercontent.com/6157049/60562044-78d74e00-9d88-11e9-98e6-a52a8c884ddd.png" alt="Firebase menu"></p><h4 id="最後一步，準備好信用卡"><a href="#最後一步，準備好信用卡" class="headerlink" title="最後一步，準備好信用卡"></a>最後一步，準備好信用卡</h4><p><strong>綁定信用卡會收到 40 臺幣信用卡的過卡費，如果選擇 Blaze 方案可以使用的免費額度有些不同，詳細可以到底部參考資料查閱。</strong></p><p>因為 <a target="_blank" rel="noopener" href="https://firebase.google.com/pricing">Firebase functions 免費版</a>對外送 Request 限定只能是 Google service ，需要升級解除此項限制。</p><p><img src="https://user-images.githubusercontent.com/6157049/60562403-00718c80-9d8a-11e9-8c30-0e02acb0d8a9.png" alt="Firebase quota"></p><h2 id="第三步-設定手動觸發-Travis-CI"><a href="#第三步-設定手動觸發-Travis-CI" class="headerlink" title="第三步 - 設定手動觸發 Travis CI"></a>第三步 - 設定手動觸發 Travis CI</h2><p>透過 <a target="_blank" rel="noopener" href="https://docs.travis-ci.com/user/triggering-builds/">Travis CI API</a> 來觸發，操作方式就直接 Show code；至於 Travis CI 對 Repository 操作權限，可以看 Tommy Chen 的 <a target="_blank" rel="noopener" href="https://zespia.tw/blog/2015/01/21/continuous-deployment-to-github-with-travis/">用 Travis CI 自動部署網站到 GitHub</a></p><h3 id="設定-Travis-CI-要做的事"><a href="#設定-Travis-CI-要做的事" class="headerlink" title="設定 Travis CI 要做的事"></a>設定 Travis CI 要做的事</h3><h4 id="參數設定"><a href="#參數設定" class="headerlink" title="參數設定"></a>參數設定</h4><p>這裡的設定可以參考 <a target="_blank" rel="noopener" href="https://docs.travis-ci.com/user/job-lifecycle/">.travis.yml</a> 的寫法，設定則寫在 config 裡面。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> body = &#123;</span><br><span class="line">  <span class="string">&quot;request&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;branch&quot;</span>:<span class="string">&quot;master&quot;</span>,</span><br><span class="line">    <span class="string">&quot;config&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;node_js&quot;</span>: [<span class="string">&quot;8&quot;</span>],</span><br><span class="line">      <span class="string">&quot;before_install&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;export TZ=Asia/Taipei&quot;</span>,</span><br><span class="line">        <span class="string">&quot;openssl aes-256-cbc -K $XXXX_key -iv $OOOO_iv -in ./.travis/id_rsa.enc -out ~/.ssh/id_rsa -d&quot;</span>,</span><br><span class="line">        <span class="string">&quot;chmod 600 ~/.ssh/id_rsa&quot;</span>,</span><br><span class="line">        <span class="string">&quot;eval $(ssh-agent)&quot;</span>,</span><br><span class="line">        <span class="string">&quot;ssh-add ~/.ssh/id_rsa&quot;</span>,</span><br><span class="line">        <span class="string">&quot;cp .travis/ssh_config ~/.ssh/config&quot;</span>,</span><br><span class="line">        <span class="string">&quot;npm config set registry https://registry.npmjs.org/&quot;</span>,</span><br><span class="line"></span><br><span class="line">        # <span class="title class_">Travis</span> <span class="variable constant_">CI</span> 預設使用 https ，為了後續操作則更新為 git</span><br><span class="line">        <span class="string">&quot;git remote set-url origin git@github.com:IvanWei/blog.git&quot;</span>,</span><br><span class="line"></span><br><span class="line">        # 下載 <span class="title class_">Issue</span> 內容，然後轉存成 <span class="variable constant_">MD</span> 檔</span><br><span class="line">        <span class="string">&quot;npm install -g @ivanwei/blog-content-source-cli&quot;</span>,</span><br><span class="line">        <span class="string">&quot;b.content refresh -R &lt;Repo&gt; -u &lt;username&gt; -l &lt;發佈的目標 Label&gt; --git-token &lt;Github 的 Personal access token&gt; -o &lt;存 Markdown 的資料夾&gt;&quot;</span>,</span><br><span class="line"></span><br><span class="line">        # 將更動的檔案更新到目標 <span class="title class_">Repository</span></span><br><span class="line">        <span class="string">&quot;git checkout master&quot;</span>,</span><br><span class="line">        <span class="string">&quot;git add .&quot;</span>,</span><br><span class="line">        <span class="string">&quot;git status&quot;</span>,</span><br><span class="line">        <span class="string">&quot;git commit -m \&quot;Write something\&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;git push origin master&quot;</span></span><br><span class="line">      ],</span><br><span class="line">      <span class="string">&quot;script&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;echo \&quot;OK!!\&quot;&quot;</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="送-Ajax-request"><a href="#送-Ajax-request" class="headerlink" title="送 Ajax request"></a>送 Ajax request</h4><p>打 request 有幾點需要注意</p><ol><li>URL 的 <code>%2F</code> 不可替換成 <code>/</code></li><li>headers 四項都需要設定上<ul><li><code>&#39;Content-Type&#39;: &#39;application/json&#39;</code></li><li><code>&#39;Accept&#39;: &#39;application/json&#39;</code></li><li><code>&#39;Travis-API-Version&#39;: 3</code></li><li><code>&#39;Authorization&#39;: &#39;token &#39; + travis_token</code></li></ul></li><li>注意使用哪一種 Travis CI ，內容上可以參考 <a target="_blank" rel="noopener" href="https://developer.travis-ci.org/gettingstarted">這裡</a><ul><li>參考資料 Private 部分不確定是否是漏洞，免費版的 <code>.org</code> 也是可以觸發 Private repository</li></ul></li><li>Travis CI API 免費版 1 小時能打 10 次，而回補次數是按時間一點一點回復，而非下一個小時一次回復成 10 次</li><li>Travis CI 的 token 取得方式<ul><li>方式一使用 <a target="_blank" rel="noopener" href="https://developer.travis-ci.org/authentication">Travis CLI 取得</a></li><li>方式二從 <a target="_blank" rel="noopener" href="https://developer.travis-ci.org/explore/#explorer">API explorer</a> 取得 (黑色區塊滑鼠移過去會顯示出 Token)，<em>沒有直接操作 Travis CI 需求的話建議使用此方法</em><br><img src="https://user-images.githubusercontent.com/6157049/60505575-8f34c980-9cf6-11e9-85b4-084dd5af8410.png" alt="API explorer"></li></ul></li><li>最後別忘了要寫成 Ajax 送 request<ul><li>以下是範例<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">`https://api.travis-ci.org/repo/<span class="subst">$&#123;username&#125;</span>%2F<span class="subst">$&#123;repo&#125;</span>/requests`</span>, &#123;</span><br><span class="line">  <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">  <span class="attr">headers</span>: &#123;</span><br><span class="line">    <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Travis-API-Version&#x27;</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="string">&#x27;Authorization&#x27;</span>: <span class="string">`token <span class="subst">$&#123;travis_token&#125;</span>`</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">body</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(body),</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li></ul></li></ol><h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><ol><li><a target="_blank" rel="noopener" href="https://firebase.google.com/support/faq/#pricing">Firebase Blaze 方案免費額度</a></li></ol><!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]--><audio id="audio" loop preload="auto" controls data-autoplay="false"><source type="audio/mpeg" src=""></audio><ul id="audio-list" style="display:none"><li title="0" data-url="/music/See_You_On_The_Otherside_The_126ers.mp3"></li></ul></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>作者: </strong>Wei Hong-Lin (Ivan Wei)</li><li class="post-copyright-title"><strong>文章標題: </strong>透過 Github Issue 更新 Blog 內容 (Firebase 版)</li><li class="post-copyright-link"><strong>文章連結: </strong><a href="/zh-tw/2019-07-02-1-mdu6sxnzdwu0njmwmtqxmtq=/" target="_blank" title="透過 Github Issue 更新 Blog 內容 (Firebase 版)">https://blog.ivanwei.co/zh-tw/2019-07-02-1-mdu6sxnzdwu0njmwmtqxmtq=/</a></li><li class="post-copyright-license"><strong>版權聲明: </strong><a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">CC BY-NC-ND 4.0</a></li></ul><div></div></div></div></div></div></div></body><script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script><script src="/js/plugin.js"></script><script src="/js/typed.js"></script><script src="/js/diaspora.js"></script><link rel="stylesheet" href="/photoswipe/photoswipe.css"><link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css"><script src="/photoswipe/photoswipe.min.js"></script><script src="/photoswipe/photoswipe-ui-default.min.js"></script><div class="pswp" tabindex="-1" role="dialog" aria-hidden="true"><div class="pswp__bg"></div><div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div><div class="pswp__item"></div><div class="pswp__item"></div></div><div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button> <button class="pswp__button pswp__button--share" title="Share"></button> <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button> <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button> <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div><script async src="https://www.googletagmanager.com/gtag/js?id=G-PTEVL7FF0X"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-PTEVL7FF0X")</script></html>